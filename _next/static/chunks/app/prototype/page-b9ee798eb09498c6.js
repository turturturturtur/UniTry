(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[633],{8471:function(e,t,s){Promise.resolve().then(s.bind(s,2164))},2164:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return o}});var l=s(7437),r=s(7138),a=s(2265),n=s(6764);function i(e){let{onGenderDetected:t}=e,s=(0,a.useRef)(null),[r,n]=(0,a.useState)(null),[i,c]=(0,a.useState)(!0),[d,o]=(0,a.useState)(null),u=(0,a.useRef)(null),[x,m]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{let e=null;return async function(){var t;if(!(null===(t=navigator.mediaDevices)||void 0===t?void 0:t.getUserMedia)){n("当前浏览器不支持摄像头调用"),c(!1);return}c(!0);try{e=await navigator.mediaDevices.getUserMedia({video:{facingMode:"user"},audio:!1}),s.current&&(s.current.srcObject=e),n(null)}catch(e){n(e instanceof Error?e.message:"无法打开摄像头，请检查权限")}finally{c(!1)}}(),()=>{e&&e.getTracks().forEach(e=>e.stop()),s.current&&(s.current.srcObject=null)}},[]),(0,a.useEffect)(()=>()=>{u.current&&URL.revokeObjectURL(u.current)},[]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsxs)("div",{className:"flex flex-1 flex-col gap-4",children:[(0,l.jsxs)("div",{className:"relative aspect-video overflow-hidden rounded-2xl border border-white/10 bg-black/60",children:[(0,l.jsx)("video",{ref:s,autoPlay:!0,playsInline:!0,muted:!0,className:"h-full w-full object-cover"}),(i||r)&&(0,l.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/60 text-sm text-white",children:r||"正在请求摄像头权限"})]}),(0,l.jsxs)("div",{className:"space-y-3",children:[(0,l.jsx)("p",{className:"text-xs text-slate-300",children:"允许浏览器访问摄像头即可获得实时预览，或上传一张静态图片进行占位展示。点击图片可放大查看。"}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)("label",{htmlFor:"preview-upload",className:"inline-flex cursor-pointer items-center gap-2 rounded-full bg-white/20 px-4 py-2 text-xs font-semibold uppercase tracking-[0.2em] text-white transition hover:bg-white/30",children:"上传图片"}),(0,l.jsx)("input",{id:"preview-upload",type:"file",accept:"image/*",className:"hidden",onChange:function(e){var s;let l=null===(s=e.target.files)||void 0===s?void 0:s[0];if(!l)return;let r=URL.createObjectURL(l);u.current&&URL.revokeObjectURL(u.current),u.current=r,o(r);let a=l.name.toLowerCase();a.includes("look1")?null==t||t("man"):a.includes("look2")?null==t||t("woman"):null==t||t(null)}}),d&&(0,l.jsx)("div",{className:"overflow-hidden rounded-2xl border border-white/10 cursor-pointer transition hover:border-white/30",onClick:()=>m(!0),children:(0,l.jsx)("img",{src:d,alt:"用户上传预览",className:"h-48 w-full object-cover"})})]})]})]}),x&&d&&(0,l.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4",onClick:()=>m(!1),children:(0,l.jsxs)("div",{className:"relative max-h-[90vh] max-w-[90vw]",children:[(0,l.jsx)("div",{className:"mb-4 text-center",children:(0,l.jsx)("p",{className:"text-xs uppercase tracking-[0.2em] text-white/60",children:"用户上传预览"})}),(0,l.jsx)("div",{className:"relative",children:(0,l.jsx)("img",{src:d,alt:"用户上传预览",className:"max-h-[80vh] w-auto object-contain"})}),(0,l.jsx)("button",{className:"mt-4 w-full rounded-full bg-white/20 px-6 py-2 text-sm text-white transition hover:bg-white/30",onClick:()=>m(!1),children:"关闭"})]})})]})}var c=s(8887),d=s(7994);function o(){let[e,t]=(0,a.useState)(null);return(0,l.jsxs)("main",{className:"mx-auto flex min-h-screen max-w-[1800px] flex-col gap-12 px-6 py-12 md:py-20",children:[(0,l.jsxs)("header",{className:"flex flex-col gap-4 text-white",children:[(0,l.jsx)("div",{className:"text-xs uppercase tracking-[0.4em] text-white/70",children:"UniTry \xb7 Prototype"}),(0,l.jsx)("h1",{className:"text-3xl font-semibold md:text-4xl",children:"实时试穿预览(Developing)"}),(0,l.jsx)("p",{className:"text-sm text-slate-300 md:text-base",children:"上传图片，查看用户选择的服装、推荐搭配以及最终穿着效果。"}),(0,l.jsx)(r.default,{href:"/",className:"self-start rounded-full border border-white/30 px-5 py-2 text-sm text-white transition hover:border-white/60",children:"返回首页"})]}),(0,l.jsxs)("section",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-4",children:[(0,l.jsx)(n.$,{gender:e}),(0,l.jsxs)("div",{className:"glass-panel flex flex-col gap-4 p-6",children:[(0,l.jsx)("p",{className:"text-xs uppercase tracking-[0.3em] text-white/70",children:"Output Preview"}),(0,l.jsx)(i,{onGenderDetected:t})]}),(0,l.jsx)(c.o,{gender:e}),(0,l.jsx)(d.Z,{gender:e})]})]})}}},function(e){e.O(0,[231,974,923,971,23,744],function(){return e(e.s=8471)}),_N_E=e.O()}]);